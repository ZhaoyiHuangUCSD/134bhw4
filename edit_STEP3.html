<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" media="only screen and (max-width: 800px)" href="./src/mobile.css" type="text/css" />
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css?family=PT+Serif" rel="stylesheet" type="text/css">
<title>Editing Page </title>
    <style>
        input[type="text"]{
            border:1px solid grey;
            width:200px;
            height:100px;
        }
        body{
            font-family: 'PT Serif', serif;
        }
        
    </style>
 

<!--Script for json-server -->

<script>
 function getParam(){
                
        let params = (new URL(document.location)).searchParams;
        let id = params.get("issueid");
        return id;
    }   
function httpPut(){
var data={};
var url = 'http://localhost:3000/issues/' + String(getParam());
var xhr=new XMLHttpRequest();
xhr.open("PATCH",url,true);
var issuetype=document.getElementById("issuetype").value;
var issuestatus = document.getElementById('issuestatus').value;
if(document.getElementById("issuedescription").value!=""){
    
        data["description"]= document.getElementById('issuedescription').value
}
    
if(document.getElementById("issuename").value!=""){
    data["title"]=document.getElementById('issuename').value
}
 if(document.getElementById("issuetype").value!=0){
     data["type"]=document.getElementById('issuetype').value
 }
  if(document.getElementById("issuestatus").value!=0){
     data["status"]=document.getElementById('issuestatus').value
 }   

xhr.setRequestHeader('Content-Type', 'application/json');
xhr.send(JSON.stringify(data));
}
    
</script>

    
</head>
<body>


<h1>Edit Issue</h1>
    <form id="myform" method="POST" >
        <b>Issue Title</b><br>
        <textarea id="issuename" rows="10" cols="30"></textarea><br>
        <b>Issue Type</b><br>
        <select id="issuetype">
            <option value=0>N/A</option>
            <option value="Error">Error</option>
            <option value="Warning">Warning</option>
        </select><br>
        <b>Issue Status</b><br>
        <select id="issuestatus">
                <option value=0>N/A</option>
                <option value="open">Open</option>
                <option value="close">Closed</option>
        </select><br>
        <b>Issue Description</b><br>
        <textarea id="issuedescription" rows="10" cols="30"></textarea><br>
        <!--Unnecessary function for local database part-->
        <!--//
        <b>Issue Priority</b><br>
        <div class="slidecontainer"><input type="range" min="1" max="3" value="2" class="slider" id="issuepriority" ></div><br>
            <b>Issue Attachment</b><br>
            <input type="file" id="issuefile"><br>
            <p>&nbsp;</p>
        //-->
            <button type="button" onclick="httpPut();window.location='table_STEP3.html'">Submit</button>
            <button type="reset">Reset</button>
    </form>



</body>
</html>